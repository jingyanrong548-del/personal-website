// Language data
const translations = {
    en: {
        // Navigation
        'nav.brand': 'Jing Yanrong',
        'nav.about': 'About',
        'nav.apps': 'Apps',
        
        // Hero
        'hero.title': 'Industrial Refrigeration & Heat Pump Systems',
        'hero.subtitle': 'Open-source tools for engineering applications',
        'hero.badge1': 'Industrial Refrigeration',
        'hero.badge2': 'Industrial Heat Pumps',
        'hero.badge3': 'Smart Refrigeration & Heat Pumps',
        
        // Purpose Notice
        'purpose.notice': 'This website is established for open-source and non-commercial purposes. All self-developed applications are provided for public benefit and research purposes only. The site operates on a voluntary, non-profit basis to share knowledge and tools with the engineering community.',
        
        // About
        'about.title': 'About',
        'about.text1': 'Jing Yanrong (荆炎荣), specializing in industrial refrigeration and industrial heat pump systems. Focus on advancing green low-carbon technologies through innovative design and intelligent applications in refrigeration and heat pump engineering.',
        'about.text2': 'This website provides practical applications and tools for energy-efficient industrial refrigeration and industrial heat pump systems, focusing on design optimization, energy efficiency analysis, and performance calculation.',
        
        // Apps
        'apps.title': 'My Applications',
        'apps.description': 'Self-Developed Application Tools',
        'apps.app0.title': 'Engineering Unit Converter',
        'apps.app0.description': 'Fast and accurate unit conversion tool for engineering calculations',
        'apps.app1.title': 'Heat Pump Calculator',
        'apps.app1.description': 'Industrial heat pump system performance calculation tool',
        'apps.app2.title': 'Refrigeration System Designer',
        'apps.app2.description': 'Design and optimization tool for industrial refrigeration systems',
        'apps.app3.title': 'Energy Efficiency Analyzer',
        'apps.app3.description': 'Analyze and optimize energy consumption of HVAC systems',
        'apps.app4.title': 'Temperature Range Optimizer',
        'apps.app4.description': 'Optimize temperature ranges for wide-range heat pump systems',
        'apps.app5.title': 'Component Sizing Tool',
        'apps.app5.description': 'Size compressors, heat exchangers, and other components',
        'apps.tags.converter': 'Converter',
        'apps.tags.unit': 'Unit',
        'apps.tags.calculation': 'Calculation',
        'apps.tags.heatPump': 'Heat Pump',
        'apps.tags.design': 'Design',
        'apps.tags.refrigeration': 'Refrigeration',
        'apps.tags.analysis': 'Analysis',
        'apps.tags.energy': 'Energy',
        'apps.tags.optimization': 'Optimization',
        'apps.tags.temperature': 'Temperature',
        'apps.tags.sizing': 'Sizing',
        'apps.tags.components': 'Components',
        'apps.available': 'Available',
        'apps.comingSoon': 'Coming Soon',
        
        // Disclaimer
        'disclaimer.title': 'Disclaimer',
        'disclaimer.text1': 'All self-developed applications on this website are provided for personal research and educational purposes only. These tools are made available on a non-commercial, open-source basis.',
        'disclaimer.text2': 'For any commercial use or commercial purposes, please contact me in advance to obtain proper authorization. Unauthorized commercial use is strictly prohibited.',
        'disclaimer.text3': 'While every effort has been made to ensure accuracy, the tools are provided "as is" without warranty of any kind. Use at your own risk.',
        
        // Contact
        'contact.title': 'Contact',
        'contact.wechat': 'WeChat: jingyanrongdalian',
        
        // Footer
        'footer.copyright': '© {year} Jing Yanrong. All rights reserved.',
        'footer.privacy': 'This website uses localStorage to save your language preference. No personal data is collected or transmitted.'
    },
    zh: {
        'nav.brand': '荆炎荣 / Jing Yanrong',
        'nav.about': '关于',
        'nav.apps': '应用',
        'hero.title': '工业制冷与热泵系统',
        'hero.subtitle': '面向工程应用的开源工具',
        'hero.badge1': '工业制冷',
        'hero.badge2': '工业热泵',
        'hero.badge3': '智能制冷热泵',
        'purpose.notice': '本网站以开源和非商业目的建立。所有自编应用仅供公益和研究目的使用。本网站以志愿服务、非营利的方式运营，旨在与工程社区分享知识和工具。',
        'about.title': '关于',
        'about.text1': '荆炎荣（Jing Yanrong），专注于工业制冷和工业热泵系统。致力于通过创新设计和智能化应用推进绿色低碳技术在制冷热泵工程中的发展。',
        'about.text2': '本网站为工业制冷和工业热泵系统提供实用的应用程序和工具，专注于设计优化、能效分析和系统性能计算。',
        'apps.title': '自编应用工具',
        'apps.description': '自编应用工具集',
        'apps.app0.title': '工程单位换算器',
        'apps.app0.description': '快速、准确的工程计算单位转换工具',
        'apps.app1.title': '热泵计算器',
        'apps.app1.description': '工业热泵系统性能计算工具',
        'apps.app2.title': '制冷系统设计器',
        'apps.app2.description': '工业制冷系统设计与优化工具',
        'apps.app3.title': '能效分析器',
        'apps.app3.description': '分析和优化暖通空调系统能耗',
        'apps.app4.title': '温度范围优化器',
        'apps.app4.description': '优化宽温域热泵系统的温度范围',
        'apps.app5.title': '部件选型工具',
        'apps.app5.description': '压缩机、换热器等部件的选型',
        'apps.tags.converter': '换算器',
        'apps.tags.unit': '单位',
        'apps.tags.calculation': '计算',
        'apps.tags.heatPump': '热泵',
        'apps.tags.design': '设计',
        'apps.tags.refrigeration': '制冷',
        'apps.tags.analysis': '分析',
        'apps.tags.energy': '能源',
        'apps.tags.optimization': '优化',
        'apps.tags.temperature': '温度',
        'apps.tags.sizing': '选型',
        'apps.tags.components': '部件',
        'apps.available': '可用',
        'apps.comingSoon': '即将推出',
        'disclaimer.title': '免责声明',
        'disclaimer.text1': '本网站所有自编应用仅供个人研究和教育目的使用。这些工具以非商业、开源方式提供。',
        'disclaimer.text2': '如用于任何商业用途或商业目的，请事先与我联系以获得授权。严禁未经授权的商业使用。',
        'disclaimer.text3': '虽已尽力确保准确性，但这些工具按"现状"提供，不提供任何形式的保证。使用风险自负。',
        'contact.title': '联系方式',
        'contact.wechat': '微信: jingyanrongdalian',
        'footer.copyright': '© {year} 荆炎荣. 保留所有权利.',
        'footer.privacy': '本网站使用本地存储保存您的语言偏好。不收集或传输任何个人数据。'
    }
};

// Language management
let currentLanguage = localStorage.getItem('language') || 'en';

function setLanguage(lang) {
    if (!translations[lang]) return;
    
    currentLanguage = lang;
    localStorage.setItem('language', lang);
    
    // Update HTML lang attribute
    document.documentElement.lang = lang === 'zh' ? 'zh-CN' : lang;
    
    // Update all elements with data-i18n attribute
    const currentYear = new Date().getFullYear();
    const elements = document.querySelectorAll('[data-i18n]');
    
    elements.forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (!key || !translations[lang] || !translations[lang][key]) {
            // Skip if key not found or translation missing
            return;
        }
        
        let text = translations[lang][key];
        // Replace {year} placeholder with current year
        text = text.replace(/{year}/g, currentYear.toString());
        
        // Safely set text content
        try {
            element.textContent = text;
        } catch (error) {
            console.warn('Failed to update element with key:', key, error);
        }
    });
    
    // Update active language button
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.getAttribute('data-lang') === lang) {
            btn.classList.add('active');
        }
    });
}

// Smooth scroll behavior and interactive features
document.addEventListener('DOMContentLoaded', function() {
    // Set initial language
    setLanguage(currentLanguage);
    
    // Language switcher buttons
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const lang = this.getAttribute('data-lang');
            setLanguage(lang);
        });
    });
    
    // Handle navigation clicks
    const navLinks = document.querySelectorAll('.nav-menu a');
    
    navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href');
            const targetSection = document.querySelector(targetId);
            
            if (targetSection) {
                const offsetTop = targetSection.offsetTop - 80;
                window.scrollTo({
                    top: offsetTop,
                    behavior: 'smooth'
                });
                
                // Update active state
                navLinks.forEach(l => l.classList.remove('active'));
                this.classList.add('active');
            }
        });
    });

    // Intersection Observer for scroll animations
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver(function(entries) {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, observerOptions);

    // Observe elements for animation
    const animatedElements = document.querySelectorAll(
        '.app-card'
    );

    animatedElements.forEach(el => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(20px)';
        el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
        observer.observe(el);
    });

    // Active navigation highlighting on scroll
    window.addEventListener('scroll', function() {
        let current = '';
        const sections = document.querySelectorAll('section[id]');
        const scrollPosition = window.pageYOffset + 150;
        
        sections.forEach(section => {
            const sectionTop = section.offsetTop;
            const sectionHeight = section.clientHeight;
            if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
                current = section.getAttribute('id');
            }
        });

        navLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href') === '#' + current) {
                link.classList.add('active');
            }
        });
    });

    // Card hover effects are now handled by CSS for better performance

    // Nav brand click to scroll to top
    const navBrand = document.querySelector('.nav-brand');
    if (navBrand) {
        navBrand.addEventListener('click', function() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
            
            // Reset active nav state
            navLinks.forEach(link => link.classList.remove('active'));
        });
    }

    // Add active class style for navigation
    const style = document.createElement('style');
    style.textContent = `
        .nav-menu a.active {
            color: var(--secondary-color);
            font-weight: 500;
        }
    `;
    document.head.appendChild(style);

    console.log('Personal homepage loaded successfully!');
});